Electronic Case Reporting Data Validation and Quality Assurance in Connecticut in 2023: Use of Powershell, Xslt, and Power Query to Improve Efficiency and Timeliness
Michael Schneider, MPH, Suzanne Speers, MPH and Ms. Nancy L Barrett, MS, MPH, Connecticut Department of Public Health
BACKGROUND: Data validation is a critical task for Informatics staff in onboarding facilities for electronic case reporting (eCR). In Connecticut (CT), individually examining eCRs was time consuming, IT infrastructure did not allow modification of a usable schematron, and R scripts worked slowly due to insufficient network resources. We assessed using MS PowerShell and MS Excel Power Query as efficient validation tools.
METHODS: We used PowerShell (PS) with extensible stylesheet language transformations (XSLT) to apply extensible markup language Path Language (Xpath) to extract and translate data from eCR files and used Power Query to import outputs into Excel for data analysis. We compared use of a PS script to an R script to assess speed of eCR data pulls over a virtual private network (VPN) and directly on the CT state network, and assessed the ability of the PS script to identify data validation issues that could be done using a schematron or by R.
RESULTS: A PS script used to assess speed was >3X faster than an R script over VPN and >16X faster on the state network; 2,700-15,000 eCRs were scanned with PS vs. 900 using R in 15 minutes. A data quality PS script using six simultaneous XSLTs on 17,827 eCRs from 83 senders (>860 facilities) ran in 10,920 sec (1.6 eCRs/sec), saved one eCR per unique encounter and removed outputs with no usable data. Outputs were imported into Excel using Power Query for further analysis.
In 8,707 unique encounters assessed for data quality, 10.3% (903/8,707) had incorrect race codes, 4.4% (385/8,707) were missing encounter codes, 20.8% (13,254/63,723) had non-coded vaccine entries, and 3.6% (643/17,827) of trigger codes were not current. The R script used to compare speed could not create the results above because that script concatenates information into one Excel cell and is not easily analyzed. Schematron use requires processing in the eCR transformation engine that can only be run by IT staff and not by Informatics staff.
CONCLUSIONS: Rapidly assessing eCRs for data quality allows faster identification of issues and quicker feedback to senders for corrections. Use of PowerShell followed by Power Query export into Excel was more efficient than R, simplified identification of files for analysis, did not rely on IT to use a schematron, and made data more available for further analysis and monitoring. PowerShell and Power Query are options for staff without easy access to other tools to more efficiently evaluate eCRs.